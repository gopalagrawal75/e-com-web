__author__ = 'Pradeep'from bson.json_util import dumpsfrom django.http import HttpResponse, JsonResponsefrom django.views.decorators.csrf import csrf_exemptimport refrom . import db,jsonResponseimport jsonfailure = dumps({"success":0})@csrf_exemptdef get_qrcode():	data = db.codes	result = data.find().distinct("qrcode")	return result	def get_vendor(location):	data = db.vendors	result = data.find({"address.location":location}).distinct("qrcode")	return resultdef show_offers(request):	active_qrcode=get_qrcode();	try:		location = request.GET['location']	except:		return HttpResponse(failure, content_type="application/json")	active_vendor=get_vendor(location)	qrcode=list(set(active_qrcode) & set(active_vendor))	data=db.offers	query = {"qrcodes":{'$in':qrcode}}	result = data.find(query , {"_id":False,"qrcodes.$":True,"weight":True , "price":True ,"offer_id":True,"img":True })	data=db.banner	query = {"qrcode":{'$in':qrcode}}	result1 = data.find(query , {"_id":False})	return jsonResponse({"success": True, "data": {"offer": result, "banner": result1 }, "total": result.count()})	'''success = dumps()	return HttpResponse(success, content_type="application/json")'''		def getLocation(request):	data = db.locations	try:		area = request.GET['area']	except:		return HttpResponse(failure, content_type="application/json")	query = {"area":area}	result = data.find(query, {"_id":False,"locations": True})	success = dumps({"success": 1, "data": result['data'][0]['location'], "total": result.count()})	return HttpResponse(success, content_type="application/json")